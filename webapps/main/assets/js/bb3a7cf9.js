"use strict";(globalThis.webpackChunkinfinity_hitab_client=globalThis.webpackChunkinfinity_hitab_client||[]).push([[8805,1259],{73337:(t,e,i)=>{i.d(e,{Kn:()=>u,fN:()=>n,k$:()=>p,nI:()=>h});var a=i(74003),o=i(63477),l=i(80661),s=i.n(l),r=i(17904);const n=async t=>{try{if("location"===t)throw new Error("location error");const e=await r.hj.get(`${a.Hg}weather/city`,{location:t,lang:a.sM?"zh":"en"},{_delay:200,_single:!0});if(0===e.code&&e.data.list.length>0)return[null,e.data.list.map((t=>({...t,cid:t.id})))];throw e}catch(t){return["catch error"]}},c=t=>(t.updateTime=s()(t.updateTime).valueOf(),t.daily=t.daily.map((t=>{const e=(0,o.sG)(t.fxDate);return{...t,fxDateStr:a.sM?e.format("M月D ddd"):e.format("MMM D, ddd"),dateStr:e.format("ddd"),weekStr:a.sM?e.format("D日"):e.format("D"),tempMax:t.tempMax+"°",tempMin:t.tempMin+"°"}})),t),d=t=>(t.updateTime=s()(t.updateTime).valueOf(),t.hourly=t.hourly.map((t=>({...t,fxTimeStr:s()(t.fxTime).format("HH:mm"),temp:t.temp+"°",windScale:a.sM?t.windScale+"级":"级"+t.windScale,windSpeed:t.windSpeed+"km/h",humidity:t.humidity+"%",precip:t.precip+"mm"}))),t),h=async t=>{try{if("location"===t)throw new Error("location error");const e=await r.hj.get(`${a.Hg}weather/daily`,{location:t,lang:a.sM?"zh":"en"},{_delay:0});if(0===e.code)return[null,c(e.data)];throw e}catch(t){return["catch error"]}},u=async t=>{try{if("location"===t)throw new Error("location error");const e=await r.hj.get(`${a.Hg}weather/hourly`,{location:t,lang:a.sM?"zh":"en"},{_delay:0});if(0===e.code)return[null,d(e.data)];throw e}catch(t){return["catch error"]}},p=async()=>{try{const t=await r.hj.get(`${a.Hg}weather/location`,{},{_delay:0});if(0===t.code)return[null,t.data];throw t}catch(t){return["catch error"]}}},84138:(t,e,i)=>{i.d(e,{i7:()=>h,iE:()=>r,m_:()=>n,x4:()=>d,zI:()=>l});var a=i(74003),o=i(73337);const l="location",s={sunny:[[100],[150]],cloudy:[[101,104],[151,154]],rain:[[300,399]],snow:[[400,499]],haze:[[500,515]]};function r(t){const e=Number(t);let i="cloudy";for(const t in s){if(s[t].some((a=>{if(1===a.length){if(e===a[0])return i=t,!0}else if(2===a.length&&e>=a[0]&&e<=a[0])return i=t,!0})))break}return i}const n=t=>`${a.c1}/weather-icon/${t}.png`,c=a.sM?"116.40528,39.90498":"-73.96900,40.77899";function d(t){return new Promise((e=>{let i=!1;const a=t=>{i=!0,e(t)};setTimeout((()=>{i||(0,o.k$)().then((e=>{let[i,o]=e;a(null===i?o:t?"":c)}))}),0),setTimeout((()=>{a(t?"":c)}),5e3)}))}const h=(t,e)=>`weather-bg-${e||"cloudy"}-${t}`},28805:(t,e,i)=>{i.r(e);i(57334);var a=i(1096),o=i(68398),l=i(79282),s=i(43451),r=i(57268),n=i(29445),c=i(41259),d=i(94209),h=i(80661),u=i.n(h),p=i(55943),v=i(61045),y=i(10435),m=i(84138),x=i(1585);const w={class:"weather-modal-main hi-scroll h-full w-full overflow-x-hidden leading-none"},g={class:"content relative pt-[20px]"},f={class:"update-time relative h-[14px] text-center font-ali-55 text-color-t3"},S={class:"now relative my-[60px] flex h-[72px] justify-between pl-[56px]"},C={class:"flex items-center"},_={class:"temp-text mr-[48px] font-ali-75 text-[72px] text-color-t1"},D={class:"flex h-full flex-col justify-between pt-[4px] pb-[12px]"},U={class:"flex items-center whitespace-nowrap text-color-t2"},W={class:"mr-[12px]"},b={class:"mr-[24px]"},M=["src"],k={class:"weather-info font-ali-55 text-color-t3"},I={class:"mr-[24px]"},H={class:"mr-[24px]"},T={class:"mr-[24px]"},q={key:0,class:"mr-[24px]"},$={key:1,class:"mr-[24px]"},j={class:"text-[16px] text-color-t1"},z=(t=>((0,r.dD)("data-v-1ad7690e"),t=t(),(0,r.Cn)(),t))((()=>(0,r._)("div",{class:"search-icon ml-[16px] flex h-[20px] w-[20px] items-center justify-center rounded-[6px] bg-color-white dark:bg-opacity-20"},[(0,r._)("i",{class:"iconfont icon-toggle_icon text-[12px] text-color-t2"})],-1))),Z={class:"hour relative"},Y={class:"ml-[56px] text-color-t2"},A={class:"inline-flex h-[160px] flex-nowrap items-center px-[36px] font-ali-55 text-color-t3"},L=["src"],N={class:"mt-[20px]"},F={class:"mt-[12px]"},P={class:"day mt-[40px]"},E={class:"ml-[56px] text-color-t2"},K={class:"seven-list hide-scroll flex h-[160px] items-center justify-between overflow-x-scroll px-[36px] font-ali-55 text-color-t3"},R=["src"],O={class:"mt-[20px]"},V={class:"mt-[12px]"},B=(0,r.aZ)({__name:"weather-modal-main",setup(t){p.ZP.use(v.Z);const e=(0,n.iH)(),i=(0,n.iH)(u()().format("YYYY-MM-DD HH:mm:ss")),a=(0,c.useWeatherStore)(),{activeNow:o,activeDay:l,activeHour:s,activeTempRange:h,activeCityLongName:B}=(0,y.Jk)(a);let G,J;return(0,r.bv)((()=>{G=new p.ZP(e.value,{...x.IO,scrollX:!0,scrollY:!1,mouseWheel:!0,bounce:!1,momentum:!1}),window.setInterval((()=>{i.value=u()().format("YYYY-MM-DD HH:mm:ss")}),1e3)})),(0,r.Ah)((()=>{J&&(clearInterval(J),J=void 0)})),(0,r.YP)((()=>{var t,e;return null===(t=s.value)||void 0===t||null===(e=t.list)||void 0===e?void 0:e.length}),(()=>{(0,r.Y3)((()=>{var t;null===(t=G)||void 0===t||t.refresh()}))})),(t,c)=>{var u,p,v,y,x,G,J,Q,X,tt,et,it,at;return(0,r.wg)(),(0,r.iD)("section",w,[(0,r._)("div",g,[(0,r._)("div",{class:(0,d.normalizeClass)([[(0,n.SU)(m.i7)("modal",null===(u=(0,n.SU)(o))||void 0===u?void 0:u.type)],"absolute top-0 left-0 right-0 h-[260px] transition-[background]"])},null,2),(0,r._)("div",f,(0,d.toDisplayString)(i.value),1),(0,r._)("div",S,[(0,r._)("div",C,[(0,r._)("div",_,(0,d.toDisplayString)(null===(p=(0,n.SU)(o))||void 0===p?void 0:p.temp),1),(0,r._)("div",D,[(0,r._)("div",U,[(0,r._)("span",W,(0,d.toDisplayString)(null===(v=(0,n.SU)(o))||void 0===v?void 0:v.text),1),(0,r._)("span",b,(0,d.toDisplayString)((0,n.SU)(h)),1),(0,r._)("img",{class:"h-[32px] w-[32px]",src:(0,n.SU)(m.m_)(null===(y=(0,n.SU)(o))||void 0===y?void 0:y.icon)},null,8,M)]),(0,r._)("div",k,[(0,r._)("span",I,(0,d.toDisplayString)((null===(x=(0,n.SU)(o))||void 0===x?void 0:x.windDir)+"："+(null===(G=(0,n.SU)(o))||void 0===G?void 0:G.windScale)),1),(0,r._)("span",H,(0,d.toDisplayString)("风速："+(null===(J=(0,n.SU)(o))||void 0===J?void 0:J.windSpeed)),1),(0,r._)("span",T,(0,d.toDisplayString)("相对湿度："+(null===(Q=(0,n.SU)(o))||void 0===Q?void 0:Q.humidity)),1),"rain"===(null===(X=(0,n.SU)(o))||void 0===X?void 0:X.type)?((0,r.wg)(),(0,r.iD)("span",q,(0,d.toDisplayString)("当前降水量："+(null===(tt=(0,n.SU)(o))||void 0===tt?void 0:tt.precip)),1)):((0,r.wg)(),(0,r.iD)("span",$,(0,d.toDisplayString)("大气压强："+(null===(et=(0,n.SU)(o))||void 0===et?void 0:et.pressure)+"hPa"),1))])])]),(0,r._)("div",{class:"change-area absolute right-0 mr-[56px] flex h-[20px] cursor-pointer items-center",onClick:c[0]||(c[0]=t=>(0,n.SU)(a).setSearchModal(!0))},[(0,r._)("div",j,(0,d.toDisplayString)((0,n.SU)(B)),1),z])]),(0,r._)("div",Z,[(0,r._)("h1",Y,(0,d.toDisplayString)("24小时预报"),1),(0,r._)("div",{ref_key:"wrapperRef",ref:e,"overflow-hidden":"",class:"box"},[(0,r._)("div",A,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(null===(it=(0,n.SU)(s))||void 0===it?void 0:it.list,(t=>((0,r.wg)(),(0,r.iD)("div",{key:t.fxTime,class:"flex min-w-[78px] flex-shrink-0 flex-col items-center rounded-[12px] px-[20px] py-[20px] hover:bg-color-m2 hover:bg-opacity-[0.06]"},[(0,r._)("img",{class:"h-[32px] w-[32px]",src:(0,n.SU)(m.m_)(t.icon)},null,8,L),(0,r._)("span",N,(0,d.toDisplayString)(t.temp),1),(0,r._)("span",F,(0,d.toDisplayString)(t.fxTimeStr),1)])))),128))])],512)]),(0,r._)("div",P,[(0,r._)("h1",E,(0,d.toDisplayString)("未来7天预报"),1),(0,r._)("div",K,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(null===(at=(0,n.SU)(l))||void 0===at?void 0:at.list,(t=>((0,r.wg)(),(0,r.iD)("div",{key:t.fxDate,class:"flex shrink-0 flex-col items-center rounded-[12px] px-[20px] py-[20px] hover:bg-color-m2 hover:bg-opacity-[0.06]"},[(0,r._)("img",{class:"h-[32px] w-[32px]",src:(0,n.SU)(m.m_)(t.iconDay)},null,8,R),(0,r._)("span",O,(0,d.toDisplayString)(`${t.tempMax} ~ ${t.tempMin}`),1),(0,r._)("span",V,(0,d.toDisplayString)(t.fxDateStr),1)])))),128))])])])])}}});const G=(0,i(76911).Z)(B,[["__scopeId","data-v-1ad7690e"]]);var J=i(34679),Q=i(81198),X=i(73337);var tt=i(17530);const et={key:0,class:"iconfont icon-position_icon absolute top-[-4px] left-[-4px] text-[20px] text-color-t2"},it={class:"flex max-w-[210px] flex-col justify-between text-color-t2"},at={class:"flex items-center"},ot={class:"text-dot"},lt=["src"],st={class:"font-ali-55 text-[12px]"},rt={class:"mr-[4px]"},nt={class:"flex items-center text-color-t1"},ct={class:"ml-[12px] text-[28px]"},dt=(0,r.aZ)({__name:"weather-modal-card",props:{city:null,location:{type:Boolean,default:!1}},setup(t){const e=t,i=(0,c.useWeatherStore)(),a=(0,r.Fl)((()=>i.getCityWeather(e.city.cid))),o=(0,r.Fl)((()=>{var t;return null===(t=a.value)||void 0===t?void 0:t.now})),l=(0,r.Fl)((()=>{var t;return null===(t=a.value)||void 0===t?void 0:t.day})),s=(0,r.Fl)((()=>{var t;if(null!==(t=l.value)&&void 0!==t&&t.list[0]){var e,i;const t=null===(e=l.value)||void 0===e?void 0:e.list[0].tempMin;return`${null===(i=l.value)||void 0===i?void 0:i.list[0].tempMax} ~ ${t}`}return""})),h=(0,r.Fl)((()=>e.city.adm2===e.city.name?e.city.name:e.city.adm2+" · "+e.city.name)),u=(0,n.iH)(!1),p=(0,r.Fl)((()=>({remove:{text:"删除",handler(){i.removeCity(e.city.cid)}}}))),v=(0,r.Fl)((()=>e.location&&i.activeCityId===m.zI||!e.location&&i.activeCityId===e.city.cid)),y=()=>{u.value||v.value||(i.setActive(e.location?m.zI:e.city.cid),setTimeout((()=>{i.setSearchModal(!1)}),200))};return(t,i)=>{var a,l,c,x;const w=tt.Z;return(0,r.wg)(),(0,r.iD)("section",{class:(0,d.normalizeClass)([[(0,n.SU)(m.i7)("card",null===(a=(0,n.SU)(o))||void 0===a?void 0:a.type),{"cursor-pointer":!(0,n.SU)(v)}],"weather-modal-card group relative mb-[12px] flex h-[80px] justify-between rounded-[8px] px-[20px] pt-[18px] pb-[20px]"]),onClick:y},[(0,n.SU)(v)?((0,r.wg)(),(0,r.iD)("i",et)):(0,r.kq)("",!0),(0,r._)("div",it,[(0,r._)("div",at,[(0,r._)("span",ot,(0,d.toDisplayString)((0,n.SU)(h)+(e.location?"（我的位置）":"")),1),(0,r._)("img",{class:"ml-[8px] h-[20px] w-[20px]",src:(0,n.SU)(m.m_)(null===(l=(0,n.SU)(o))||void 0===l?void 0:l.icon)},null,8,lt)]),(0,r._)("div",st,[(0,r._)("span",rt,(0,d.toDisplayString)(null===(c=(0,n.SU)(o))||void 0===c?void 0:c.text),1),(0,r._)("span",null,(0,d.toDisplayString)((0,n.SU)(s)),1)])]),(0,r._)("div",nt,[e.location||(0,n.SU)(v)?(0,r.kq)("",!0):((0,r.wg)(),(0,r.j4)(w,{key:0,show:u.value,"onUpdate:show":i[0]||(i[0]=t=>u.value=t),class:"",options:(0,n.SU)(p)},{reference:(0,r.w5)((()=>[(0,r._)("button",{class:(0,d.normalizeClass)(u.value?"block":"hidden group-hover:block")},[(0,r._)("i",{class:(0,d.normalizeClass)([[u.value?"text-opacity-80":"text-opacity-60 hover:text-opacity-80"],"iconfont icon-single_hover_icon text-[20px] text-color-t1"])},null,2)],2)])),_:1},8,["show","options"])),(0,r._)("div",ct,(0,d.toDisplayString)(null===(x=(0,n.SU)(o))||void 0===x?void 0:x.temp),1)])],2)}}}),ht=dt,ut={key:0,class:"loading absolute inset-0 flex items-center justify-center"},pt=[(0,r._)("i",{class:"iconfont icon-loading_small animate-[spin_1.2s_linear_infinite] text-[40px] text-color-m2 text-opacity-20"},null,-1)],vt={key:1,class:"content relative mx-auto mt-[60px] w-[352px]"},yt={class:"citys mt-[33px]"},mt=["onClick"],xt={class:"text-color-t2"},wt=(0,r.aZ)({__name:"weather-modal-search",setup(t){const e=(0,n.iH)(!1),i=(0,c.useWeatherStore)(),{searchValue:a,updateSearchValue:o,searchListShow:s,cityList:h}=(()=>{const t=(0,n.iH)(""),e=(0,n.iH)([]),i=(0,r.Fl)((()=>!!t.value));return{searchValue:t,searchListShow:i,cityList:e,updateSearchValue:async i=>{if(t.value=i,i){const[t,a]=await(0,X.fN)(i);if(t||!a)return void(e.value=[]);e.value=a}else setTimeout((()=>{e.value=[]}),0)}}})(),u=()=>{e.value||(i.setSearchModal(!1),o(""))};return(t,c)=>{const p=Q.Z,v=J.Z,y=l.Z;return(0,r.wg)(),(0,r.j4)(y,{class:"absolute inset-0",ani:"fade",show:(0,n.SU)(i).searchModalShow},{default:(0,r.w5)((()=>[(0,r._)("div",{class:"mask absolute inset-0 bg-color-b3 bg-opacity-95",onClick:u}),e.value?((0,r.wg)(),(0,r.iD)("div",ut,pt)):((0,r.wg)(),(0,r.iD)("div",vt,[(0,r.Wm)(p,{value:(0,n.SU)(a),icon:"icon-magnifier_icon  !text-color-t2",placeholder:"搜索",class:"","onUpdate:value":(0,n.SU)(o)},null,8,["value","placeholder","onUpdate:value"]),(0,r._)("div",yt,[(0,r.Wm)(y,{show:(0,n.SU)(s)},{default:(0,r.w5)((()=>[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,n.SU)(h),(t=>((0,r.wg)(),(0,r.iD)("div",{key:t.cid,class:"mb-[12px] flex h-[36px] cursor-pointer items-center justify-between rounded-[8px] px-[12px] transition-colors hover:bg-color-m2 hover:bg-opacity-[0.08]",onClick:a=>(async t=>{e.value=!0;try{await i.addCity(t)}catch(t){}e.value=!1,i.setActive(t.cid),i.setSearchModal(!1),o("")})(t)},[(0,r._)("div",xt,(0,d.toDisplayString)((t.name===t.adm2?"":`${t.adm2}-`)+t.name),1)],8,mt)))),128)),(0,n.SU)(s)&&0===(0,n.SU)(h).length?((0,r.wg)(),(0,r.j4)(v,{key:0,class:"mt-[80px]",icon:"icon-fail_icon",desc:"暂无搜索结果"},null,8,["desc"])):(0,r.kq)("",!0)])),_:1},8,["show"]),(0,r.Wm)(y,{show:!(0,n.SU)(s)},{default:(0,r.w5)((()=>[(0,r.Wm)(ht,{location:!0,city:(0,n.SU)(i).locationCity},null,8,["city"]),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)((0,n.SU)(i).addedCity,(t=>((0,r.wg)(),(0,r.j4)(ht,{key:t.cid,location:!1,city:t},null,8,["city"])))),128))])),_:1},8,["show"])])]))])),_:1},8,["show"])}}}),gt={class:"h-full w-full bg-color-b3"},ft=(0,r.aZ)({__name:"widget-weather-modal",setup(t){const e=(0,c.useWeatherStore)();return(0,r.YP)((()=>e.activeCid),(()=>{e.reqWeather(e.activeCid)})),(t,i)=>{const a=s.Z,o=l.Z;return(0,r.wg)(),(0,r.j4)(o,{class:"widget-weather-modal",ani:"fade",show:(0,n.SU)(e).modalShow},{default:(0,r.w5)((()=>[(0,r.Wm)(a,{"full-screen-btn":!1,onOnClose:i[0]||(i[0]=t=>(0,n.SU)(e).setModal(!1))},{default:(0,r.w5)((()=>[(0,r._)("div",gt,[(0,r.Wm)(G),(0,r.Wm)(wt)])])),_:1})])),_:1},8,["show"])}}});var St=i(96755),Ct=i(75008),_t=i(63477);(()=>{const t=(0,_t.em)(),e=(0,o.createApp)(ft);(0,Ct.f)(e),e.use(St.M),e.use(a.Z),e.mount(t)})()},41259:(t,e,i)=>{i.r(e),i.d(e,{useWeatherStore:()=>p,widgetInfo:()=>u});var a=i(84522),o=i(10435),l=i(84138),s=i(73337),r=i(34906),n=i(94119),c=i(24581),d=i(12793);const h={cityId:l.zI},u=(0,c.E0)(c.Rm.timerMark),p=(0,o.Q_)(a.BU.weather,{syncStorage:{watch:["weathers","locationCity","addedCity","activeCityId"]},syncCloud:{watch:["addedCity","activeCityId"]},state:()=>({searchModalShow:!1,modalShow:!1,weathers:{},locationCity:{cid:"",name:"",adm1:"",adm2:"",expired:0},addedCity:[],activeCityId:l.zI,activeWidgetId:"",widgetData:h}),getters:{allCids(){return this.addedCity.map((t=>t.cid)).concat(this.locationCity.cid)},activeCid(){return this.activeCityId===l.zI?this.locationCity.cid:this.activeCityId},getCityWeather:t=>e=>t.weathers[e],activeCityWeather(){return this.getCityWeather(this.activeCid)},activeNow(){var t;return null===(t=this.activeCityWeather)||void 0===t?void 0:t.now},activeDay(){var t;return null===(t=this.activeCityWeather)||void 0===t?void 0:t.day},activeHour(){var t;return null===(t=this.activeCityWeather)||void 0===t?void 0:t.hour},activeTempRange(){var t,e;const i=null===(t=this.activeCityWeather)||void 0===t||null===(e=t.day)||void 0===e?void 0:e.list;if(i){const t=i[0].tempMin;return`${i[0].tempMax} ~ ${t}`}return""},activeCity(){return this.activeCityId===l.zI?this.locationCity:this.addedCity.find((t=>t.cid===this.activeCityId))},addedCityIds(){return this.addedCity.map((t=>t.cid))},activeCityLongName(){return this.activeCity?this.activeCity.adm2===this.activeCity.name?this.activeCity.name:this.activeCity.adm2+" · "+this.activeCity.name:""}},actions:{saveWidgetData(t,e){const i=(0,d.i)(),a=i.getIconData(t);i.saveIcon({...a,id:t,widgetData:e})},getCity(t){return t==l.zI?this.locationCity:this.addedCity.find((e=>e.cid===t))||this.locationCity},getCityLongName(t){const e=this.getCity(t);return e?e.adm2===e.name?e.name:e.adm2+" · "+e.name:""},getWeather(t){const e=this.getCity(t).cid;return this.getCityWeather(e)},getTempRange(t){var e,i;const a=null===(e=this.getWeather(t))||void 0===e||null===(i=e.day)||void 0===i?void 0:i.list;if(a){const t=a[0].tempMin;return`${a[0].tempMax} ~ ${t}`}return""},async setSearchModal(t){this.searchModalShow=t,t&&(await this.reqLocation(!1),this.reqAllWeather())},async setModal(t,e){e&&(this.activeWidgetId=e),n.G.setStatus(c.Rm.weather,t),t?this.reqAllWeather():this.searchModalShow=!1,this.modalShow=t},setActive(t,e){this.activeCityId=t,t&&(e||this.activeWidgetId)&&(this.widgetData={cityId:t},this.saveWidgetData(e||(e||this.activeWidgetId),this.widgetData))},async reqHourWeather(t){const[e,i]=await(0,s.Kn)(t);if(e)return;const a={list:i.hourly,expired:(0,r.Z)(i.expiredTime,Date.now()+12e4,Date.now()+36e5),updateTime:i.updateTime},o=i.hourly[0],n={updateTime:i.updateTime,type:(0,l.iE)(o.icon),temp:o.temp,icon:o.icon,text:o.text,windDir:o.windDir,windScale:o.windScale,windSpeed:o.windSpeed,humidity:o.humidity,precip:o.precip,pressure:o.pressure};this.weathers[t]={...this.weathers[t],hour:a,now:n},this.weathers={...this.weathers}},clearWeathers(){Object.keys(this.weathers).forEach((t=>{this.allCids.includes(t)||delete this.weathers[t]}))},async reqDayWeather(t){const[e,i]=await(0,s.nI)(t);if(e)return;const a={list:i.daily,expired:(0,r.Z)(i.expiredTime,Date.now()+12e4,Date.now()+288e5),updateTime:i.updateTime};this.weathers[t]={...this.weathers[t],day:a},this.weathers={...this.weathers}},async reqWeather(t){var e;t===l.zI&&(t=null===(e=this.getCity(t))||void 0===e?void 0:e.cid);if(!t)return;const i=this.getCityWeather(t),a=[];i?((!i.day||i.day.expired<Date.now())&&a.push(this.reqDayWeather(t)),(!i.hour||i.hour.expired<Date.now())&&a.push(this.reqHourWeather(t))):a.push(this.reqDayWeather(t),this.reqHourWeather(t)),await Promise.all(a)},async reqAllWeather(){await Promise.all([this.reqWeather(this.locationCity.cid),...this.addedCity.map((t=>this.reqWeather(t.cid)))])},async reqLocation(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{if(!e){if(this.locationCity.expired>Date.now())return;if(t&&this.locationCity.cid)return}const i=await(0,l.x4)(!!this.locationCity.cid);if(!i)return;const[a,o]=await(0,s.fN)(i);if(a||!o)return;this.locationCity={cid:o[0].id,name:o[0].name,adm1:o[0].adm1,adm2:o[0].adm2,expired:Date.now()+2e3}}catch(t){}},async addCity(t){const e=this.addedCity.findIndex((e=>e.cid===t.cid));e>-1&&this.addedCity.splice(e,1),this.addedCity.unshift(t),this.addedCity.length>4&&(this.addedCity.length=4),this.addedCity=[...this.addedCity],await this.reqAllWeather(),this.clearWeathers()},removeCity(t){const e=this.addedCity.findIndex((e=>e.cid===t));e>-1&&(this.addedCity.splice(e,1),this.addedCity=[...this.addedCity]),this.clearWeathers()}}})}}]);