/*! For license information please see 1a111984.js.LICENSE.txt */
"use strict";(globalThis.webpackChunkinfinity_hitab_client=globalThis.webpackChunkinfinity_hitab_client||[]).push([[4591],{13409:(e,t,i)=>{i.d(t,{o7:()=>z,t4:()=>I,O9:()=>T,f8:()=>U,dJ:()=>H,zY:()=>O,hQ:()=>G,XM:()=>F,sy:()=>E,ST:()=>_});var a=i(994),n=i(80661),s=i.n(n),r=i(74003),o=i(63477),l=i(55332);let c;try{new EventTarget,c=!0}catch(e){c=!1}var d=c?EventTarget:class{constructor(){this.e={}}addEventListener(e,t,i=!1){this.t(e).push(t)}removeEventListener(e,t,i=!1){const a=this.t(e),n=a.indexOf(t);n>-1&&a.splice(n,1)}dispatchEvent(e){return e.target=this,Object.freeze(e),this.t(e.type).forEach((t=>t(e))),!0}t(e){return this.e[e]=this.e[e]||[]}};var g=c?Event:class{constructor(e){this.type=e}};class h extends g{constructor(e,t){super(e),this.newState=t.newState,this.oldState=t.oldState,this.originalEvent=t.originalEvent}}const u="active",p="passive",v="hidden",f="frozen",w="terminated",m="object"==typeof safari&&safari.pushNotification,b=["focus","blur","visibilitychange","freeze","resume","pageshow","onpageshow"in self?"pagehide":"unload"],x=e=>(e.preventDefault(),e.returnValue="Are you sure?"),y=[[u,p,v,w],[u,p,v,f],[v,p,u],[f,v],[f,u],[f,p]].map((e=>e.reduce(((e,t,i)=>(e[t]=i,e)),{}))),S=()=>document.visibilityState===v?v:document.hasFocus()?u:p;var C=new class extends d{constructor(){super();const e=S();this.s=e,this.i=[],this.a=this.a.bind(this),b.forEach((e=>addEventListener(e,this.a,!0))),m&&addEventListener("beforeunload",(e=>{this.n=setTimeout((()=>{e.defaultPrevented||e.returnValue.length>0||this.r(e,v)}),0)}))}get state(){return this.s}get pageWasDiscarded(){return document.wasDiscarded||!1}addUnsavedChanges(e){!this.i.indexOf(e)>-1&&(0===this.i.length&&addEventListener("beforeunload",x),this.i.push(e))}removeUnsavedChanges(e){const t=this.i.indexOf(e);t>-1&&(this.i.splice(t,1),0===this.i.length&&removeEventListener("beforeunload",x))}r(e,t){if(t!==this.s){const i=((e,t)=>{for(let i,a=0;i=y[a];++a){const a=i[e],n=i[t];if(a>=0&&n>=0&&n>a)return Object.keys(i).slice(a,n+1)}return[]})(this.s,t);for(let t=0;t<i.length-1;++t){const a=i[t],n=i[t+1];this.s=n,this.dispatchEvent(new h("statechange",{oldState:a,newState:n,originalEvent:e}))}}}a(e){switch(m&&clearTimeout(this.n),e.type){case"pageshow":case"resume":this.r(e,S());break;case"focus":this.r(e,u);break;case"blur":this.s===u&&this.r(e,S());break;case"pagehide":case"unload":this.r(e,e.persisted?f:w);break;case"visibilitychange":this.s!==f&&this.s!==w&&this.r(e,S());break;case"freeze":this.r(e,f)}}};const L=C,T={font:["rgba(248, 248, 248, 1)","rgba(28, 28, 30, 1)","rgba(58, 58, 60, 1)","rgba(95, 95, 99, 1)","rgba(142, 142, 147, 1)","rgba(176, 176, 182, 1)","rgba(199, 199, 204, 1)"],background:["rgba(248, 248, 248, 1)","rgba(58, 58, 60, 1)","rgba(28, 28, 30, 1)","rgba(244, 171, 18, 1)","rgba(74, 197, 92, 1)","rgba(35, 207, 168, 1)","rgba(67, 133, 241, 1)","rgba(56, 100, 255, 1)","rgba(118, 33, 249, 1)","rgba(224, 78, 150, 1)","rgba(224, 78, 78, 1)","rgba(253, 90, 90, 1)","rgba(183, 163, 150, 1)","rgba(171, 131, 131, 1)","rgba(182, 150, 135, 1)","rgba(109, 131, 95, 1)","rgba(125, 171, 136, 1)","rgba(158, 172, 175, 1)","rgba(103, 124, 170, 1)"]},k=["rgba(183, 163, 150, 1)","rgba(171, 131, 131, 1)","rgba(182, 150, 135, 1)","rgba(109, 131, 95, 1)","rgba(125, 171, 136, 1)","rgba(158, 172, 175, 1)","rgba(103, 124, 170, 1)"],O=()=>(0,a.Z)(k),I=Array(20).fill(0).map(((e,t)=>{const i=`${t+1}`.padStart(2,"0");return{bgImage:{large:`${r.c1}/widget-background/background${i}_larg.jpg`,medium:`${r.c1}/widget-background/background${i}_medium.jpg`,small:`${r.c1}/widget-background/background${i}_small.jpg`},thumbnail:`${r.c1}/widget-background/background${i}.jpg`}})),D=(e,t)=>{let i=!1;e.isLeapYear()&&1===e.month()&&29===e.date()&&(i=!0);let a=(0,o.sG)(e.format(`${t}-MM-DD`));return i&&!a.isLeapYear()&&(a=a.add(-1,"day")),a.valueOf()>=A.valueOf()||(a=(0,o.sG)(e.format(`${t+1}-MM-DD`)),i&&!a.isLeapYear()&&(a=a.add(-1,"day"))),a},P=e=>{const t=l.q7.fromDate(new Date(e)),i=l.q7.fromDate(new Date).getYear(),a=s()((0,o.EJ)({year:i,month:t.getMonth(),day:t.getDay()}));return a.valueOf()>=A.valueOf()?a:s()((0,o.EJ)({year:i+1,month:t.getMonth(),day:t.getDay()}))},V=e=>{if(e.date()>=A.date())return(0,o.sG)(`${A.year()}-${A.month()+1}-${Math.min(A.daysInMonth(),e.date())}`);const t=A.add(1,"month");return(0,o.sG)(`${t.year()}-${t.month()+1}-${Math.min(t.daysInMonth(),e.date())}`)},M=e=>{const t=l.q7.fromDate(new Date),i=l.q7.fromDate(new Date(e)),a=t.getDay(),n=i.getDay();if(n>=a)return s()((0,o.EJ)({year:t.getYear(),month:t.getMonth(),day:n}));const r=l.o7.fromYm(t.getYear(),t.getMonth()).next(1);return s()((0,o.EJ)({year:r.getYear(),month:r.getMonth(),day:n}))},_=e=>{const t=Date.now(),i=s()().endOf("day").valueOf()+1;return window.setTimeout((()=>{try{e(i),_(e)}catch(e){}}),i-t)},F=e=>{const t=Date.now(),i=s()().add(30,"minute").valueOf();return window.setTimeout((()=>{try{e(i),F(e)}catch(e){}}),i-t)},E=e=>{const t=Date.now(),i=s()().add(5,"minute").valueOf();return window.setTimeout((()=>{try{e(i),E(e)}catch(e){}}),i-t)};let A=s()().startOf("day"),$=A.year();_((()=>{A=s()(),$=A.year()}));const H=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solar";if(!e)return 0;if(e>=A.valueOf())return s()(e).diff(A,"day");if("lunar"===t){return M(e).diff(A,"day")}const i=s()(e),a=V(i),n=a.diff(A,"day");return n},G=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"solar";if(!e)return 0;if(e>=A.valueOf())return s()(e).diff(A,"day");if("lunar"===t){return P(e).diff(A,"day")}const i=s()(e),a=D(i,$),n=a.diff(A,"day");return n},U=e=>{const t=Math.floor(e/86400);e-=86400*t;const i=Math.floor(e/3600)%24;e-=3600*i;const a=Math.floor(e/60)%60;return{d:t,h:i,m:a,s:(e-=60*a)%60}};class z{views=new Map;execTime=0;execTimer=null;isPageVisible=!0;setViewVisibleInterval(){0!==this.views.size?this.isPageVisible?this.isViewVisible?this.setInterval(this.interval):this.setInterval(this.intervalOnViewOut):this.setPageVisibleInterval():this.setInterval(0)}setPageVisibleInterval(){0!==this.views.size?this.isPageVisible?this.setViewVisibleInterval():this.setInterval(this.intervalOnPageHide):this.setInterval(0)}setInterval(e){if(this.execTimer&&window.clearTimeout(this.execTimer),e<=0)return;let t=e;this.execTime&&(t=e-(Date.now()-this.execTime),t<0&&(t=0)),this.execTimer=window.setTimeout((async()=>{await this.execFn(),this.setInterval(e)}),t)}watchPageStatus(){L.addEventListener("statechange",(e=>{"hidden"===e.newState?this.isPageVisible=!1:this.isPageVisible=!0,this.setPageVisibleInterval()}))}onChangeViewVisible(){let e=!1;this.views.forEach((t=>{e||(e=t)})),this.isViewVisible=e,this.setViewVisibleInterval()}initIo(){this.io=new IntersectionObserver((e=>{e.forEach((e=>{this.views.has(e.target)&&this.views.set(e.target,e.intersectionRatio>0)})),this.onChangeViewVisible()}),{threshold:[0]})}constructor(e,t){if(!t.interval)throw new Error("请设置间隔时间");this.interval=t.interval,this.intervalOnViewOut=t.intervalOnViewOut,this.intervalOnPageHide=t.intervalOnPageHide,this.execFn=async()=>{try{await e()}catch(e){}this.execTime=Date.now()},t.immediate&&this.execFn(),this.watchPageStatus(),this.initIo(),t.view&&this.addView(t.view)}addView(e){this.views.set(e,!1),this.io.observe(e)}removeView(e){this.views.delete(e),this.io.unobserve(e),this.onChangeViewVisible()}}},22854:(e,t,i)=>{i.d(t,{C:()=>s});var a=i(29445),n=i(57268);const s=(e,t,i)=>{const s=(0,a.iH)(e);t.onChangeState=e=>{s.value={...e}};const r=(0,n.Fl)((()=>i?i[s.value.size]:null));return{propsState:s,HomeComp:r}}},13214:(e,t,i)=>{i.r(t),i.d(t,{mountHome:()=>m,widgetApp:()=>w});var a=i(29445),n=i(68398),s=i(57268),r=i(79652),o=i(95329),l=i(88514),c=i(36160),d=i(13409),g=i(80661),h=i.n(g),u=i(74891);const p=(0,s.aZ)({__name:"widget-chatgpt-home",props:{size:null,id:null},setup(e){const t=e,i=(0,o.useUserStore)(),n=(0,c.useChatGptStore)();(0,s.YP)((()=>n.activeTheme),(e=>{(0,l.o)(e)})),(0,s.YP)((()=>i.isLogin),(e=>{e?((0,u.l4)(!0),n.reqConversionList(!0),n.reqAssistantList()):n.resetPage()})),(0,s.bv)((()=>{g(),(0,l.o)(n.activeTheme)})),(0,d.ST)((()=>{g()}));const g=()=>{h()(n.overLimit).add(1,"day").get("date")<=h()().get("date")&&n.setOverLimit(0)},{HomeComp:p}=(0,r.SK)(t),{clickWidget:v}=(0,r.dd)();return(e,t)=>((0,s.wg)(),(0,s.iD)("section",{class:"contents cursor-pointer",onClick:t[0]||(t[0]=function(){return(0,a.SU)(v)&&(0,a.SU)(v)(...arguments)})},[((0,s.wg)(),(0,s.j4)((0,s.LL)((0,a.SU)(p))))]))}});var v=i(96755),f=i(75008);const w=(0,a.iH)(null),m=(e,t)=>{const i=(0,n.createApp)(p,t);return(0,f.f)(i),w.value=i,i.use(v.M),i.mount(e),w.value}},79652:(e,t,i)=>{i.d(t,{SK:()=>V,dd:()=>M,UV:()=>_});var a=i(57268),n=i(94209),s=i(29445),r=i(95329);const o={class:"insert-shadow relative flex h-full rounded-[var(--icon-home-radius)] bg-[#303B75] chat-p:bg-[#0A0920] chat-w:bg-[#FFFFFF]"},l={class:"relative z-[1] flex h-full w-full items-center pl-[20px] icon-m:pl-[16px] icon-s:pl-[12px]"},c=(e=>((0,a.dD)("data-v-76aade3c"),e=e(),(0,a.Cn)(),e))((()=>(0,a._)("div",{draggable:"false",class:"h-[48px] w-[48px] bg-[url(@widget/widget-chatgpt/img/ai-logo-green.png)] bg-contain bg-center bg-no-repeat icon-m:h-[40px] icon-m:w-[40px] icon-s:h-[36px] icon-s:w-[36px] chat-p:bg-[url(@widget/widget-chatgpt/img/ai-logo-purple.png)]",alt:""},null,-1))),d={class:"flex grow flex-col pl-[16px] icon-m:pl-[12px] icon-s:pl-[8px]"},g={class:"mt-[4px] font-ali-55 text-[14px] leading-[20px] text-[#AAAFCC] icon-m:text-[14px] icon-m:leading-[20px] icon-s:text-[12px] icon-s:leading-[17px] chat-w:text-[#3A3A3C]"},h=(0,a.aZ)({__name:"chatgpt-small",setup(e){const t=(0,r.useUserStore)();return(e,i)=>((0,a.wg)(),(0,a.iD)("section",o,[(0,a._)("div",l,[c,(0,a._)("div",d,[(0,a._)("div",{draggable:"false",class:(0,n.normalizeClass)([[(0,s.SU)(t).chatStatus.vip?"h-[14px] bg-[url(@widget/widget-chatgpt/img/ai-title-pro-fff.png)] icon-m:h-[14px] icon-s:h-[12px]":"h-[16px] bg-[url(@widget/widget-chatgpt/img/ai-title-fff.png)] icon-m:h-[16px] icon-s:h-[12px]"],"w-full bg-contain bg-left bg-no-repeat chat-w:bg-[url(@widget/widget-chatgpt/img/ai-title-pro-000.png)]"]),alt:""},null,2),(0,a._)("span",g,(0,n.toDisplayString)("简单高效智能"),1)])])]))}});var u=i(76911);const p=(0,u.Z)(h,[["__scopeId","data-v-76aade3c"]]),v=e=>((0,a.dD)("data-v-233ed0cc"),e=e(),(0,a.Cn)(),e),f={class:"insert-shadow relative flex h-full overflow-hidden rounded-[var(--icon-home-radius)] bg-[#303B75] bg-[url(https://static.wetab.link/hitab/chatgpt-widget/chatgptbg2xpng.png)] bg-cover bg-no-repeat chat-p:bg-[url(@widget/widget-chatgpt/img/chatgptbg-pro.png)] chat-w:bg-[url(@widget/widget-chatgpt/img/w-chat-home-bg-m.png)]"},w={class:"full flex w-full flex-col items-center pt-[26px] icon-m:pt-[22px] icon-s:pt-[18px]"},m=v((()=>(0,a._)("div",{draggable:"false",class:"h-[88px] w-[88px] bg-[url(@widget/widget-chatgpt/img/ai-logo-green.png)] bg-contain bg-center bg-no-repeat icon-m:h-[76px] icon-m:w-[76px] icon-s:h-[64px] icon-s:w-[64px] chat-p:bg-[url(@widget/widget-chatgpt/img/ai-logo-purple.png)]",alt:""},null,-1))),b={class:"flex w-full flex-col items-center pt-[26px] icon-m:pt-[22px] icon-s:pt-[18px]"},x={class:"my-[8px] font-ali-55 text-[14px] leading-[16px] text-[#AAAFCC] icon-m:text-[12px] icon-s:text-[12px] chat-p:text-[#A98FFF] chat-w:text-[#3A3A3C]"},y=v((()=>(0,a._)("div",{class:"flex items-center text-[#2CCB92] chat-p:text-[#FFFFFF] chat-w:text-[#2CCB92]"},[(0,a._)("span",{class:"font-ali-65 text-[16px] leading-[22px] icon-m:leading-[16px] icon-s:leading-[16px]"}," Start "),(0,a._)("i",{class:"iconfont icon-icon_right text-[14px]"})],-1))),S=(0,a.aZ)({__name:"chatgpt-medium",setup(e){const t=(0,r.useUserStore)();return(e,i)=>((0,a.wg)(),(0,a.iD)("section",f,[(0,a._)("div",w,[m,(0,a._)("div",b,[(0,a._)("div",{draggable:"false",class:(0,n.normalizeClass)([[(0,s.SU)(t).chatStatus.vip?"h-[16px] bg-[url(@widget/widget-chatgpt/img/ai-title-pro-fff.png)]":"h-[22px] bg-[url(@widget/widget-chatgpt/img/ai-title-fff.png)] icon-m:h-[16px] icon-s:h-[14px]"],"w-full bg-contain bg-center bg-no-repeat chat-w:bg-[url(@widget/widget-chatgpt/img/ai-title-pro-000.png)]"]),alt:""},null,2),(0,a._)("span",x,(0,n.toDisplayString)("简单高效智能"),1),y])])]))}}),C=(0,u.Z)(S,[["__scopeId","data-v-233ed0cc"]]);var L=i(13214),T=i(22854),k=i(36160),O=i(10435),I=i(17319),D=i(63477),P=i(74003);const V=e=>{const t={s:p,m:C};return(0,T.C)(e,L.widgetApp.value,t)},M=()=>{const e=(0,k.useChatGptStore)();return{clickWidget:()=>{e.setModal(!0)},onCloseModal:()=>{e.setModal(!1),setTimeout((()=>{e.panelShowType&&e.setPanelShowType(""),"chat-expense"===e.panelType&&e.setPanelType("chatai")}),0)},show:(0,O.Jk)(e).modalShow}},_=()=>{const e=(0,k.useChatGptStore)(),t=(0,r.useUserStore)(),i=(0,O.Jk)(e),n=(0,s.iH)(!1),o=(0,s.iH)();function l(t){e.setPanelShowType(t)}return(0,a.bv)((()=>{var t;null===(t=o.value)||void 0===t||t.addEventListener("scroll",(()=>{!function(){var t,a,n;if(!o.value)return;if(i.pagination.value.finished||i.pagination.value.loading)return;const s=null===(t=o.value)||void 0===t?void 0:t.clientHeight,r=null===(a=o.value)||void 0===a?void 0:a.scrollHeight,l=null===(n=o.value)||void 0===n?void 0:n.scrollTop;s&&r&&l&&s+l>=r-10&&e.reqConversionList()}()}))})),{list:i.linksList,customList:i.customLinks,selectLink:i.selectedLink,panelType:i.panelType,panelShowType:i.panelShowType,conversionDataList:i.conversionDataList,activeConversionId:i.activeConversionId,activeConversionItem:i.activeConversionItem,userOperationDisabled:i.userOperationDisabled,paymentOrderData:i.paymentOrderData,planList:i.planList,currentPlanList:i.currentPlanList,planSelectedIndex:i.planSelectedIndex,vipGroup:i.vipGroup,localCurrentTime:i.localCurrentTime,payOrderIds:i.payOrderIds,chatModelList:i.chatModelList,activeSelectModel:i.activeSelectModel,chatVipDetail:i.chatVipDetail,isFreeOrder:i.isFreeOrder,fromTag:i.fromTag,setSelectLink:function(t){t.iframe?e.setSelectLink(t):window.open(t.url,"_blank")},isFull:n,setIsFull:function(e){n.value=e},setpanelType:function(t){e.setPanelType(t)},setPanelShowType:l,addLink:function(t){i.customLinks.value.find((e=>e.url===t.url))?I.R.warn({message:"已存在该链接"}):e.addCustomLink(t)},removeLink:function(t,a){var n;e.removeCustomLink(t),a.url===(null===(n=i.selectedLink.value)||void 0===n?void 0:n.url)&&e.setSelectLink(i.linksList.value[0])},removeOriginLink:function(t){var a;e.removeOriginLink(t.id),t.url===(null===(a=i.selectedLink.value)||void 0===a?void 0:a.url)&&e.setSelectLink(i.linksList.value[0])},onClickNewChat:function(){var t;const a=i.conversionDataList.value;null===(t=o.value)||void 0===t||t.scrollTo({top:0,behavior:"smooth"});const n=a.find((e=>e.id===k.NEWCHAT_ID));if(n){if(!(n.messages.length>0))return void e.setActiveConversionId(k.NEWCHAT_ID);e.setNewLocalId()}e.newChatHandler()},sendMessage:function(t){e.sendChatMessage(t,i.activeConversionId.value)},reGenerate:function(){e.reGenerateLastAnwser(i.activeConversionId.value)},exportMarkdown:function(){const e=i.activeConversionItem.value.messages;if(0===e.length)return;let t="";e.forEach((e=>{const i="assistant"===e.role?"## 来自WeTab AI的消息:\n":"## 来自你的消息:\n";t+=i,t+=e.content+"\r\n\n"}));const a=`WetabAI-${Math.ceil(Date.now()*Math.random())}.md`;(0,D.tf)(t,a,P.s$?"custom/hitab":"text/plain")},scrollListRef:o,onPauseChat:function(){e.abourtStream()},sponsorShow:i.sponsorShow,closeSponsor:function(){e.setSponsorShow(!1)},vipTipsShow:i.vipTipsShow,vipTipsContent:i.vipTipsContent,closeVipTipsShow:function(){e.setVipTipsShow(!1,"")},getPayCode:async function(t,i){return await e.getPayCode(t,i)},getPlanList:function(){e.getPlanList()},getPayList:async function(){return await e.getPayList()},checkAllOrders:async function(){return await e.checkAllOrders()},getVipGroup:function(){t.chatStatus.vip&&e.getVipGroup()},checkPayOrderIds:async function(t){const i=await e.checkRecentOrderIds(t);if(i)return i;throw new Error("no paidId")},createOrder:async function(t,i){return await e.createPaymentOrder(t,i)},saveCreateOrderParams:function(t){e.setCreateOrderParams(t)},refreshOrder:async function(){const{planId:t,payPlatform:a}=i.createOrderParams.value;return await e.createPaymentOrder(t,a)},onSelectModel:function(t){e.setSelectModel(t)},getChatModelList:function(){e.getChatModels()},modifyPlanForFree:async function(){return await e.confirmChangePlanForFree()},getVipDetail:async function(){return await e.getUserVipDetail()},clearOrderIds:function(){e.clearOrderIds()},setPlanSelectedIndex:function(t){e.setPlanSelectedIndex(t)},setFromTag:function(t){e.setFromTag(t)},backToPlanList:function(){"double11"===i.fromTag.value?l("chatai-double11"):l("chat-expense")},closeWidget:()=>{e.setModal(!1),e.setPanelShowType("")}}}}}]);